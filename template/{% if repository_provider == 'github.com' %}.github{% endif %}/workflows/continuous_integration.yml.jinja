name: "Continuous integration"

on:
  push:
  pull_request:

jobs:
  nox:
    name: "Nox"
    strategy:
      matrix:
        include:
        - os: "ubuntu-latest"
          python-version: "3.10"
          nox-session: "black"
        - os: "ubuntu-latest"
          python-version: "3.10"
          nox-session: "isort"
        - os: "ubuntu-latest"
          python-version: "3.10"
          nox-session: "flake8"
        - os: "ubuntu-latest"
          python-version: "3.10"
          nox-session: "mypy"
        - os: "ubuntu-latest"
          python-version: "3.10"
          nox-session: "pytest"
        - os: "ubuntu-latest"
          python-version: "3.10"
          nox-session: "audit"
    runs-on: "${{ '{{' }} matrix.os {{ '}}' }}"
    steps:
    - uses: actions/checkout@v3
    - name: "Set up PDM"
      uses: "pdm-project/setup-pdm@main"
      with:
        python-version: "${{ '{{' }} matrix.python-version {{ '}}' }}"
    - name: "Install Nox"
      run: "pdm sync -G nox --no-default --no-self"
    - name: "Run Nox"
      run: "pdm run nox"
      env:
        NOXSESSION: "${{ '{{' }} matrix.nox-session {{ '}}' }}"
